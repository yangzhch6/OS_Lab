;程序源代码（myos1.asm）
;注意在该程序中，只可按下大写ABCD
;注意在该程序中，只可按下大写ABCD
;注意在该程序中，只可按下大写ABCD
;注意在该程序中，只可按下大写ABCD
;注意在该程序中，只可按下大写ABCD
org  8000h		       ; BIOS将把引导扇区加载到0:7C00h处，并开始执行
OffSetA equ 8200h
OffSetB equ 8400h
OffSetC equ 8600h
OffSetD equ 8800h
	mov	ax, cs	       ; 置其他段寄存器值与CS相同
	mov	ds, ax	       ; 数据段
	mov	bp, Message		 ; BP=当前串的偏移地址
	mov	ax, ds		 ; ES:BP = 串地址
	mov	es, ax		 ; 置ES=DS
	mov	cx, MessageLength  ; CX = 串长（=9）
	mov	ax, 1301h		 ; AH = 13h（功能号）、AL = 01h（光标置于串尾）
	mov	bx, 0007h		 ; 页号为0(BH = 0) 黑底白字(BL = 07h)
    mov dh, 0		       ; 行号=0
	mov	dl, 0			 ; 列号=0
	int	10h			 ; BIOS的10h功能：显示一行字符
LoadnA:
     ;读软盘或硬盘上的若干物理扇区到内存的ES:BX处：
      mov ax,cs                ;段地址 ; 存放数据的内存基地址
      mov es,ax                ;设置段地址（不能直接mov es,段地址）
      mov bx, OffSetA  ;偏移地址; 存放数据的内存偏移地址
      mov ah,2                 ; 功能号
      mov al,1                 ;扇区数
      mov dl,0                 ;驱动器号 ; 软盘为0，硬盘和U盘为80H
      mov dh,0                 ;磁头号 ; 起始编号为0
      mov ch,0                 ;柱面号 ; 起始编号为0
      mov cl,2                 ;起始扇区号 ; 起始编号为1
      int 13H ;                调用读磁盘BIOS的13h功能
      ; 用户程序a.com已加载到指定内存区域中 
	  
LoadnB:
	;读软盘或硬盘上的若干物理扇区到内存的ES:BX处：
      mov ax,cs                ;段地址 ; 存放数据的内存基地址
      mov es,ax                ;设置段地址（不能直接mov es,段地址）
      mov bx, OffSetB  ;偏移地址; 存放数据的内存偏移地址
      mov ah,2                 ;功能号
      mov al,1                 ;扇区数
      mov dl,0                 ;驱动器号 ; 软盘为0，硬盘和U盘为80H
      mov dh,0                 ;磁头号 ; 起始编号为0
      mov ch,0                 ;柱面号 ; 起始编号为0
      mov cl,3                 ;起始扇区号 ; 起始编号为1
      int 13H                  ;调用读磁盘BIOS的13h功能
      ; 用户程序a.com已加载到指定内存区域中	
LoadnC:
	;读软盘或硬盘上的若干物理扇区到内存的ES:BX处：
      mov ax,cs                ;段地址 ; 存放数据的内存基地址
      mov es,ax                ;设置段地址（不能直接mov es,段地址）
      mov bx, OffSetC  ;偏移地址; 存放数据的内存偏移地址
      mov ah,2                 ;功能号
      mov al,1                 ;扇区数
      mov dl,0                 ;驱动器号 ; 软盘为0，硬盘和U盘为80H
      mov dh,0                 ;磁头号 ; 起始编号为0
      mov ch,0                 ;柱面号 ; 起始编号为0
      mov cl,4                 ;起始扇区号 ; 起始编号为1
      int 13H                  ;调用读磁盘BIOS的13h功能
      ; 用户程序a.com已加载到指定内存区域?
LoadnD:
	;读软盘或硬盘上的若干物理扇区到内存的ES:BX处：
      mov ax,cs                ;段地址 ; 存放数据的内存基地址
      mov es,ax                ;设置段地址（不能直接mov es,段地址）
      mov bx, OffSetD  ;偏移地址; 存放数据的内存偏移地址
      mov ah,2                 ;功能号
      mov al,1                 ;扇区数
      mov dl,0                 ;驱动器号 ; 软盘为0，硬盘和U盘为80H
      mov dh,0                 ;磁头号 ; 起始编号为0
      mov ch,0                 ;柱面号 ; 起始编号为0
      mov cl,5                 ;起始扇区号 ; 起始编号为1
      int 13H                  ;调用读磁盘BIOS的13h功能
      ; 用户程序a.com已加载到指定内存区域?	  
	  
	  
start:
	  mov bl,[Key]
	  cmp bl,1
	  jnz jumpA
	  call OffSetA
jumpA:
	  mov bl,[Key+1]
	  cmp bl,1
	  jnz jumpB
	  call OffSetB
jumpB:
	  mov bl,[Key+2]
	  cmp bl,1
	  jnz jumpC
	  call OffSetC
jumpC:
	  mov bl,[Key+3]
	  cmp bl,1
	  jnz jumpD
	  call OffSetD
jumpD:
	  mov ah,1
	  int 16h
      jz start
	  mov bx,ax
	  mov bh,0
	  mov al,[Key+bx-41h]
	  cmp al,1
	  jnz one
	  mov byte[Key+bx-41h],0	
input:	  
	  mov ah,0
	  int 16h
	  jmp start
one:	  
	  mov byte[Key+bx-41h],1
      jmp input
Message:
      db 'Press A,B,C,D to run/stop the program '
MessageLength  equ ($-Message)	  
Key:  
	  db 0,0,0,0

   ;   times 510-($-$$) db 0
   ;   db 0x55,0xaa

